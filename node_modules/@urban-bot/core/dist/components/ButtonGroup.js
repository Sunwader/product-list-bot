"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const react_1 = __importDefault(require("react"));
const hooks_1 = require("../hooks/hooks");
const formatButtonElement_1 = require("../utils/formatButtonElement");
const array_flatten_1 = require("array-flatten");
const formatMarkupLanguageElement_1 = require("../utils/formatMarkupLanguageElement");
const getParseMode_1 = require("../utils/getParseMode");
const groupFlatArray_1 = require("../utils/groupFlatArray");
const isArrayMatrix_1 = require("../utils/isArrayMatrix");
function ButtonGroup({ children, title, isNewMessageEveryRender: isNewMessageEveryRenderProp, parseMode, disableNotification, replyToMessageId, forceReply, maxColumns, isReplyButtons = false, ...otherProps }) {
    const { $$managerBot, isNewMessageEveryRender: isNewMessageEveryRenderContext, chat, parseMode: parseModeContext, bot, } = hooks_1.useBotContext();
    let buttons = formatButtonElement_1.formatButtonElement(children);
    if (typeof maxColumns === 'number') {
        if (!isArrayMatrix_1.isArrayMatrix(buttons)) {
            buttons = groupFlatArray_1.groupFlatArray(buttons, maxColumns);
        }
        else {
            console.error('When you use "maxColumns" the buttons children must be flatten array');
        }
    }
    const finalParseMode = getParseMode_1.getParseMode(title, parseMode, parseModeContext, bot.defaultParseMode);
    const formattedTitle = formatMarkupLanguageElement_1.formatMarkupLanguageElement(title, finalParseMode);
    hooks_1.useAction((ctx) => {
        var _a;
        const { actionId } = ctx;
        const button = array_flatten_1.flatten(buttons).find(({ id }) => {
            return actionId === id;
        });
        (_a = button === null || button === void 0 ? void 0 : button.onClick) === null || _a === void 0 ? void 0 : _a.call(button, ctx);
    });
    return (react_1.default.createElement("urban-buttons", { chat: chat, "$$managerBot": $$managerBot, isNewMessageEveryRender: isNewMessageEveryRenderProp !== null && isNewMessageEveryRenderProp !== void 0 ? isNewMessageEveryRenderProp : isNewMessageEveryRenderContext, data: {
            disableNotification,
            replyToMessageId,
            forceReply,
            parseMode: finalParseMode,
            buttons,
            title: formattedTitle,
            isReplyButtons,
            ...otherProps,
        } }));
}
exports.ButtonGroup = ButtonGroup;
function Button(_props) {
    return null;
}
exports.Button = Button;
//# sourceMappingURL=ButtonGroup.js.map